
<div class="card">
    <p-table [value]="[noticia]" [tableStyle]="{ 'min-width': '50rem'}">
        <ng-template pTemplate="caption">
            <div class="flex align-items-center justify-content-between">
                Editar Noticia
               
            </div>
        </ng-template>
        <ng-template pTemplate="header">
            <tr>
                <th>Nombre</th>
                <th>Categoria</th>
                <th>Foto</th>
                <th>enlace</th>
                <th><app-edit-noticia-data [listaCategorias]="listaCategorias" [id]="id"></app-edit-noticia-data></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-noticia>
            <tr>
                <td>{{ noticia.titulo }}</td>
                @for (categoria of listaCategorias; track categoria.id) {
                    @if(categoria.id==noticia.idCategoria){

                        <td>{{ categoria.nombre }}</td>
                    }
                }
                @if(noticia.foto!=undefined){

                    <td><img [src]="noticia.foto" [alt]="noticia.titulo" width="100" class="shadow-4"></td>
                }@else {
                    <td>[Sin foto]</td>
                }
                @if(noticia.enlace!=undefined){

                    <td colspan="2"><a target="_blank" href="{{noticia.enlace}}">{{noticia.enlace}}</a></td>
                }@else {
                    <td colspan="2">[Sin enlace]</td>
                }
            </tr>
        </ng-template>
    </p-table>
</div>
<app-nueva-seccion [noticia]="noticia" [tipo]="0"></app-nueva-seccion>

@if(noticia.secciones){
   
    
    @if(noticia.secciones.length>1){
        @for (seccion of noticia.secciones; track seccion.id) {
           
            <div class="card" style="margin-top: 10px;">
                <p-table [value]="[seccion]" [tableStyle]="{ 'min-width': '50rem'}">
                    <ng-template pTemplate="caption">
                <div class="flex align-items-center justify-content-between">
                    Seccion nº{{contarSecciones(seccion)}}
                </div>
        </ng-template>
        <ng-template pTemplate="header">
            <tr>
                <th [width]="30">Titulo</th>
                <th [width]="30">Foto</th>
                <th [width]="20">Texto</th>
                <th [width]="50"><app-edit-noticia-data [listaCategorias]="listaCategorias"  [id]="id"></app-edit-noticia-data></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-seccion>
            <tr>
                <td>{{ seccion.titulo }}</td>
                @if(seccion.foto!=undefined){
                    
                    <td><img [src]="seccion.foto" [alt]="seccion.titulo" width="100" class="shadow-4"></td>
                }@else {
                    <td>[Sin foto]</td>
                }
                <td style="max-width: 300px;">
                    <div style="word-wrap: break-word;">
                        {{seccion.texto}}
                    </div>
                </td>         
            </tr>
        </ng-template>
        <ng-template pTemplate="summary">
            <p-button icon="pi pi-plus" label="Añadir enlace"></p-button>
            @if(seccion.enlaces){
                @if(seccion.enlaces.length>0){

                    <div class="flex align-items-center justify-content-between" style="overflow-wrap: break-word;">
                    
                       <br>
                        @for (enlace of seccion.enlaces; track enlace.id) {
                            <div class="enlace-container">
                                <a href="{{enlace.url}}">{{enlace.textoClave}}</a>
                                <p-button  icon="pi pi-pencil"></p-button>
                            </div>
                        }
                    </div>
                }
        
            }
            </ng-template>
        </p-table>
</div>
}
}@else{

    <div class="card" style="margin-top: 10px;">
        <p-table [value]="noticia.secciones!" [tableStyle]="{ 'min-width': '50rem'}">
        <ng-template pTemplate="caption">
            <div class="flex align-items-center justify-content-between">
                Añade la primera seccion
                
            </div>
        </ng-template>
    </p-table>
</div>
}
}